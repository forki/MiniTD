<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
	<Product 
	    Name="MiniTDSetup" Manufacturer="CodingConnected e.U."
      Id="C1B4FFF3-E899-424A-BC0A-9C5BDD4B89DE"
      UpgradeCode="82DD19E5-1617-4DB7-9160-034E6E916210"
	    Language="1033" Version="1.0.0.0">
		
    <Package 
        Id="*" Keywords="Installer" Description="MiniTD 1.0.0 Setup" Manufacturer="CodingConnected e.U."
        InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    
	  <Directory Id="TARGETDIR" Name="SourceDir">
	    <Directory Id="ProgramFilesFolder" Name="PFiles">
	      <Directory Id="INSTALLFOLDER" Name="MiniTD" >
          
	        <Component Id='MainExecutable' Guid='16AAF2C9-F31D-4FED-8630-12DFD8347C59'>
	          <File Id='MiniTDEXE' Name='MiniTD.exe' Source='../MiniTD/bin/Debug/MiniTD.exe' KeyPath='yes' >
	            <Shortcut Id="startmenuMiniTD" Directory="ProgramMenuDir" Name="MiniTD"
	                      WorkingDirectory='INSTALLDIR' Icon="MiniTD.exe" IconIndex="0" Advertise="yes" />
	          </File>
	          <File Id='DragDropDLL' Name='GongSolutions.Wpf.DragDrop.dll' Source='../MiniTD/bin/Debug/GongSolutions.Wpf.DragDrop.dll' KeyPath='no' />
	          <File Id='InteractionsDLL' Name='Microsoft.Expression.Interactions.dll' Source='../MiniTD/bin/Debug/Microsoft.Expression.Interactions.dll' KeyPath='no' />
	          <File Id='InteractivityDLL' Name='System.Windows.Interactivity.dll' Source='../MiniTD/bin/Debug/System.Windows.Interactivity.dll' KeyPath='no' />
	          <File Id='WpfToolkitDLL' Name='Xceed.Wpf.Toolkit.dll' Source='../MiniTD/bin/Debug/Xceed.Wpf.Toolkit.dll' KeyPath='no' />
        
	          <ProgId Id='MiniTD.mtd' Description='MiniTD file' Icon='MiniTDEXE'>
	            <Extension Id='mtd' ContentType='application/mtd'>
	              <Verb Id='open' Command='Open' TargetFile='MiniTDEXE' Argument='"%1"' />
	            </Extension>
	          </ProgId>
              
	        </Component>
	      </Directory>
	    </Directory>
	    <Directory Id="ProgramMenuFolder" Name="Programs">
	      <Directory Id="ProgramMenuDir" Name="MiniTD">
	        <Component Id="ProgramMenuDir" Guid="BA59F463-7C47-49F6-9796-60D26E0FAA0C">
	          <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
	          <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
	        </Component>
	      </Directory>
	    </Directory>
	  </Directory>
    
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    
		<MediaTemplate EmbedCab="yes" />
    
	  <Feature Id='Complete' Level='1'>
	    <ComponentRef Id='MainExecutable' />
	    <ComponentRef Id='ProgramMenuDir' />
	  </Feature>  
    
    <Feature Id="ProductFeature" Title="MiniTDSetup" Level="1">
			<ComponentGroupRef Id="ProductComponents" />
		</Feature>
	  <Icon Id="MiniTD.exe" SourceFile="../MiniTD/bin/Debug/MiniTD.exe" />
	</Product>

	<Fragment>
	</Fragment>

	<Fragment>
		<ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">

      
		</ComponentGroup>
	</Fragment>
</Wix>
